(window.webpackJsonp=window.webpackJsonp||[]).push([[133,103],{1180:function(e,t,n){"use strict";n(46),n(44);var r=n(13);t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,n=e.runOnMount,o=void 0===n||n;return{data:function(){return{runOnMount:o}},computed:{featureName:function(){return this.feature||t},canAccessFeature:function(){return this.checkCanAccessFeature(this.featureName)},planFeatures:function(){var e,t;return(null===(e=this.user)||void 0===e||null===(t=e.plan)||void 0===t?void 0:t.features)||[]}},methods:{promptForUpgrade:function(){this.canAccessFeature||r.a.$emit(r.b.UserOpenDashboardUpgradeModal,{onClose:this.handleCancelUpgrade})},handleCancelUpgrade:function(){console.log("cancelled")},checkCanAccessFeature:function(e){return!e||!this.planFeatures.length||this.planFeatures.includes(e)}},mounted:function(){this.user||console.error("No user availale for feature locking"),this.runOnMount&&this.promptForUpgrade()}}}},1181:function(e,t,n){"use strict";n(16),n(15),n(12),n(17),n(18);var r=n(3),o=n(324),c=n(1180),l=n(1219),d=n(30);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var h={mixins:[Object(c.a)({runOnMount:!1}),l.a],props:{enableFeatureLock:{type:Boolean,default:!0},user:{type:Object,required:!0},text:{type:String,required:!0},feature:{type:String,required:!0}},components:{Crown:o.a},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({isPremiumFeature:function(){var e;return void 0!==(null===(e=this.fullFeature)||void 0===e?void 0:e.isPremium)?this.fullFeature.isPremium:this.checkIsPremiumFeature(this.feature)},hasBrandPlan:function(){var e,t,n;return"account-plan"===(null===(e=this.user)||void 0===e?void 0:e.plan.package.code)||"brand-plan"===(null===(t=this.user)||void 0===t?void 0:t.plan.package.code)||"agency-plan"===(null===(n=this.user)||void 0===n?void 0:n.plan.package.code)},showCrown:function(){return this.isPremiumFeature&&!this.hasBrandPlan},fullFeature:function(){return this.getFeatureById(this.feature)}},Object(d.c)({getFeatureById:"app/getFeatureById"})),methods:{handleClick:function(e){if(this.enableFeatureLock&&this.isPremiumFeature&&!this.canAccessFeature)return this.promptForUpgrade();this.$emit("continue",e)},handleCancelUpgrade:function(){this.$emit("cancel")}}},m=h,v=n(8),component=Object(v.a)(m,(function(){var e=this,t=e._self._c;return t("button",{staticClass:"btn",attrs:{slot:"buttons",type:"button"},on:{click:e.handleClick},slot:"buttons"},[e.showCrown?t("Crown",{staticClass:"mr-2",attrs:{contained:!1}}):e._e(),e._v("\n\n  "+e._s(e.text)+"\n")],1)}),[],!1,null,null,null);t.a=component.exports},1352:function(e,t,n){var content=n(1406);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(95).default)("123cc302",content,!0,{sourceMap:!1})},1398:function(e,t,n){"use strict";var r=n(330),o=(n(68),n(16),n(15),n(12),n(17),n(18),n(3)),c=n(31),l=n(1),d=(n(19),n(35),n(23),n(34),n(40),n(87),n(1181)),f=n(485),h=n.n(f),m=n(170),content=(n(13),n(84)),v={components:{Modal:m.a},props:{logo:{type:Object,required:!0},active:{type:Boolean,default:!1},siteName:{type:String,default:""}},mixins:[Object(content.d)(["modals/deletion"],!0)],methods:{handleCloseModal:function(e){e.stopPropagation(),this.$emit("close")},onDeleteConfirmed:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.stopPropagation(),t.$emit("close"),t.$emit("deleted");case 3:case"end":return n.stop()}}),n)})))()}}},_=n(8),O=Object(_.a)(v,(function(){var e=this,t=e._self._c;return t("div",[t("Modal",{attrs:{"can-close":!0,scope:"delete-logo",small:!0,active:e.active},on:{close:function(t){return e.$emit("close")}}},[e.contentReady?t("div",{staticClass:"text-center text-black"},[t("h1",{staticClass:"text-3xl mb-5"},[e._v(e._s(e.page.site.title))]),e._v(" "),t("p",{staticClass:"text-xs font-normal mb-8"},[e._v("\n        "+e._s(e.page.site.description_beginning)+"\n        "),e.siteName?t("span",[e._v("\n          "+e._s(e.page.site.description_middle)+"\n          "),t("span",{staticClass:"font-bold"},[e._v(e._s(e.siteName))])]):e._e(),e._v(e._s(e.page.site.description_ending)+"\n      ")]),e._v(" "),t("div",{staticClass:"grid gap-2 xs:grid-cols-2"},[t("button",{staticClass:"btn btn-tertiary",attrs:{type:"button",loading:!e.logo,disabled:!e.logo},on:{click:e.handleCloseModal}},[e._v("\n          "+e._s(e.page.site.deny_button_text)+"\n        ")]),e._v(" "),t("button",{staticClass:"btn btn-danger",attrs:{type:"button",loading:!e.logo,disabled:!e.logo},on:{click:e.onDeleteConfirmed}},[e._v("\n          "+e._s(e.page.site.confirm_button_text)+"\n        ")])])]):e._e()])],1)}),[],!1,null,null,null).exports,y=n(121),w=n(30),x=n(41),C=n(21);function j(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?j(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):j(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var P={components:{PremiumButton:d.a,TrashIcon:h.a,DeleteSiteModal:O,Skeleton:y.a},mixins:[Object(content.d)(["package-dash/website","data/error-toasts"],!0),content.b],props:{logo:{type:Object,required:!0},user:{type:Object,required:!0},site:{type:Object,required:!0}},data:function(){return{submittingRequest:!1,isPublishing:!1,confirmDeleteOpen:!1,logos:[],loading:!0}},mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(x.b)(e.$api),r=n.listSavedLogos,t.next=3,Promise.all([r().then((function(e){return e.data})),e.fetchSite(e.site.id)]);case 3:o=t.sent,l=Object(c.a)(o,1),d=l[0],e.logos=d,e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},computed:k(k(k({},Object(w.c)("sites",["findSiteByConnectedPackage"])),Object(w.e)(["flags","billing"])),{},{customDomain:function(){return this.siteProperties&&this.siteProperties.site_domain||null},defaultDomain:function(){return this.siteProperties&&this.siteProperties.site_default_domain||null},siteProperties:function(){var e;return(null===(e=this.site)||void 0===e?void 0:e.site_properties)||null},siteIsTrial:function(){var e;return!(null!==(e=this.site)&&void 0!==e&&e.package)},siteHasBeenViewed:function(){var e;return!(null===(e=this.site)||void 0===e||!e.last_visited)},siteNeedsTemplate:function(){var e;return"NEEDS_TEMPLATE"===(null===(e=this.site)||void 0===e?void 0:e.status)},buttonText:function(){var e;return this.contentReady?!this.siteIsTrial||null!==(e=this.site)&&void 0!==e&&e.site_name?this.buttons.manage_website.text:this.buttons.add_website.text:""},cardColumns:function(){return this.contentReady?this.page.website.website_card.columns:{}},canPublish:function(){return!!this.site.package},publishButton:function(){return this.contentReady?this.page.website.footer.button:{}},buttonData:function(){return[this.page.website.website_card]},formattedDate:function(){return this.site?this.formatDate(this.site.date_updated):null},canDelete:function(){return!(!this.site||!this.siteSubscription)&&this.siteSubscription.cancel_at_period_end},siteSubscription:function(){var e=this;return this.billing.stripe_subscriptions.find((function(sub){return sub.id===e.site.subscription_id}))}}),methods:k(k({},Object(w.b)({fetchSite:"sites/fetchSite",updateSite:"sites/updateSite",deleteSite:"sites/deleteSite",performSso:"sites/performSso",createSite:"sites/createSite"})),{},{closeDeleteModal:function(){this.confirmDeleteOpen=!1},handleDeleteClicked:function(e){e.stopPropagation(),this.confirmDeleteOpen=!0},onManageWebsite:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.submittingRequest=!0,C.a.debug("onManageWebsite: Website is being managed"),e.site&&!e.siteNeedsTemplate){t.next=4;break}return t.abrupt("return",e.$router.push("/dashboard/".concat(e.logo.id,"/website/template-picker")));case 4:return t.prev=4,t.next=7,e.performSso(e.site.id);case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(4),e.submittingRequest=!1;case 12:case"end":return t.stop()}}),t,null,[[4,9]])})))()},deleteWebsite:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canDelete){t.next=4;break}e.$toast.error(e.page["error-toasts"].site_delete_not_allowed),t.next=13;break;case 4:return t.prev=4,t.next=7,e.deleteSite({site:e.site});case 7:e.$toast.success("Your website has been deleted."),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),e.$toast.error(e.page["error-toasts"].generic);case 13:case"end":return t.stop()}}),t,null,[[4,10]])})))()},handlePublishSite:function(){if(this.canPublish)return this.publish();this.$router.push("/dashboard/".concat(this.logo.id,"/upgrade?includes_full_site=true"))},publish:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.isPublishing=!0,t.next=4,e.updateSite({site:e.site,published:!0});case 4:return t.next=6,e.performSso(e.site.id);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),t.t0.response.data.message.match("template")?e.$router.push("/dashboard/".concat(e.logo.id,"/website/template-picker")):(e.contentReady&&e.$toast.error(e.page["error-toasts"].site_publish_failed),e.$router.push("/dashboard/".concat(e.logo.id,"/upgrade?includes_full_site=true")));case 11:return t.prev=11,e.isPublishing=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()},formatUnixDate:function(e){return this.formatDate(1e3*e)},formatDate:function(e){return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})},getLogoName:function(e){var t=this.logos.find((function(t){return t.id===e}));return t?t.wordmark:null}})},S=(n(1405),Object(_.a)(P,(function(){var e=this,t=e._self._c;return t("div",[e.loading?t("Skeleton",{staticClass:"w-full h-80 lg:h-20"}):t("div",{staticClass:"flex flex-col lg:grid grid-cols-4 gap-6 lg:items-center text-xs"},[t("div",{staticClass:"space-y-1"},[t("p",{staticClass:"text-sm font-bold break-words"},[e._v("\n        "+e._s(e.site&&e.site.connected_logo_package?'Linked to "'.concat(e.getLogoName(e.site.connected_logo_package),'"'):"Not linked")+"\n      ")]),e._v(" "),e.siteProperties&&e.site.published?t("a",{staticClass:"text-enterprise-primary",attrs:{target:"_blank",href:"https://".concat(e.customDomain||e.defaultDomain)}},[e._v("\n        "+e._s(e.customDomain||"Visit site")+"\n      ")]):e._e(),e._v(" "),e.flags.enable_delete_site_btn?t("button",{staticClass:"btn text-xs p-0 text-red-500 hover:underline focus:shadow-outline-red",attrs:{type:"button",loading:!e.logo,disabled:!e.logo},on:{click:e.handleDeleteClicked}},[t("TrashIcon",{staticClass:"w-4 h-4 mr-1"}),e._v("\n        Delete website\n      ")],1):e._e()]),e._v(" "),t("div",{staticClass:"space-y-1"},[t("p",{staticClass:"text-sm font-bold lg:hidden mb-2"},[e._v("\n        "+e._s(e.cardColumns.status?e.cardColumns.status:"")+"\n      ")]),e._v(" "),t("p",[e._v(e._s(e.site&&e.site.published?"Published":"Not Published"))]),e._v(" "),t("p",[e._v("Last Updated on "+e._s(e.site&&e.formattedDate?e.formattedDate:""))])]),e._v(" "),t("div",{staticClass:"space-y-1"},[t("p",{staticClass:"text-sm font-bold lg:hidden mb-2"},[e._v("\n        "+e._s(e.cardColumns.expires?e.cardColumns.expires:"")+"\n      ")]),e._v(" "),t("p",[e._v("\n        "+e._s(e.siteSubscription?e.formatUnixDate(e.siteSubscription.current_period_end):"-")+"\n      ")])]),e._v(" "),t("div",[t("div",{staticClass:"flex justify-center flex-col lg:items-end gap-2"},[t("PremiumButton",e._b({staticClass:"btn-tertiary w-full site-card-btn",attrs:{loading:e.submittingRequest,disabled:e.submittingRequest,"enable-feature-lock":!1},on:{continue:e.onManageWebsite}},"PremiumButton",{feature:"website-files",text:e.buttonText,user:e.user},!1)),e._v(" "),t("button",{staticClass:"btn btn-secondary w-full site-card-btn",attrs:{id:e.publishButton.id,type:"button",disabled:e.isPublishing,loading:e.isPublishing},on:{click:e.publish}},[e._v("\n          "+e._s(e.publishButton.text)+"\n        ")])],1)])]),e._v(" "),t("DeleteSiteModal",{attrs:{logo:e.logo,active:e.confirmDeleteOpen,siteName:e.site&&e.site.site_name?e.site.site_name:""},on:{close:e.closeDeleteModal,deleted:e.deleteWebsite}})],1)}),[],!1,null,"4ff7bd0b",null).exports),D={components:{Container:r.a,SiteCardRow:S,Skeleton:y.a},mixins:[Object(content.d)(["package-dash/website"],!0)],props:{logo:{type:Object,required:!0},user:{type:Object,required:!0},sites:{type:Array,required:!0},loading:{type:Boolean,default:!1}},computed:{cardColumns:function(){return this.contentReady?this.page.website_card.columns:{}}}},R=Object(_.a)(D,(function(){var e=this,t=e._self._c;return t("div",[e.loading?t("Skeleton",{staticClass:"w-full h-96 lg:h-48"}):t("Container",{attrs:{showSeparator:!1}},[t("div",{staticClass:"flex justify-between lg:grid grid-cols-4 gap-6 items-center px-6 py-4 text-lg font-bold border-b",attrs:{slot:"header"},slot:"header"},[e.contentReady?t("div",{staticClass:"contents"},[t("p",[e._v(e._s(e.cardColumns.title?e.cardColumns.title:""))]),e._v(" "),t("p",{staticClass:"hidden lg:block"},[e._v("\n          "+e._s(e.cardColumns.status?e.cardColumns.status:"")+"\n        ")]),e._v(" "),t("p",{staticClass:"hidden lg:block"},[e._v("\n          "+e._s(e.cardColumns.expires?e.cardColumns.expires:"")+"\n        ")])]):t("Skeleton",{staticClass:"w-full h-7 col-span-3"})],1),e._v(" "),t("div",{staticClass:"p-6 flex flex-col gap-8"},e._l(e.sites,(function(n){return t("SiteCardRow",{key:n.id,attrs:{logo:e.logo,user:e.user,site:n}})})),1)])],1)}),[],!1,null,null,null);t.a=R.exports},1405:function(e,t,n){"use strict";n(1352)},1406:function(e,t,n){var r=n(94)((function(i){return i[1]}));r.push([e.i,".site-card-btn[data-v-4ff7bd0b]{max-width:10rem}",""]),r.locals={},e.exports=r},485:function(e,t,n){n(16),n(15),n(12),n(17),n(18);var r=n(38),o=n(39),c=["class","staticClass","style","staticStyle","attrs"];function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}e.exports={functional:!0,render:function(e,t){var n=t._c,data=(t._v,t.data),d=t.children,f=void 0===d?[]:d,h=data.class,m=data.staticClass,style=data.style,v=data.staticStyle,_=data.attrs,O=void 0===_?{}:_,y=o(data,c);return n("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){r(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[h,m],style:[style,v],attrs:Object.assign({fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},O)},y),f.concat([n("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"}})]))}}}}]);
//# sourceMappingURL=0de0d62.js.map